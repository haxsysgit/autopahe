================================================================================
                    AutoPahe Testing Guide
              Comprehensive Testing for All Features
================================================================================

This guide provides step-by-step testing procedures for all implemented
features across Phase 1, 2, 3, and 4.


================================================================================
SECTION 1: QUICK VALIDATION (5 Minutes)
================================================================================

Test basic functionality is working:

1. Syntax Check
   python3 -m py_compile auto_pahe.py ap_core/*.py

2. Help Display
   python3 auto_pahe.py --help
   # Should show all new flags

3. Config Generation
   python3 auto_pahe.py --write-config /tmp/test_config.ini
   # Should create file with sample config

4. Cache Stats (empty initially)
   python3 auto_pahe.py --cache stats
   # Should show 0 files


================================================================================
SECTION 2: SEARCH FEATURES (10 Minutes)
================================================================================

2.1 BASIC SEARCH
----------------
python3 auto_pahe.py -s "Naruto"
# Should show search results

2.2 SEARCH WITH YEAR FILTER
----------------------------
python3 auto_pahe.py -s "Naruto" --year 2007
# Should filter results by 2007

2.3 SEARCH WITH STATUS FILTER
------------------------------
python3 auto_pahe.py -s "Naruto" --status "Finished"
# Should filter results by status

2.4 COMBINED FILTERS
--------------------
python3 auto_pahe.py -s "Naruto" --year 2007 --status "Finished"
# Should apply both filters

2.5 VERBOSE SEARCH
------------------
python3 auto_pahe.py -s "Naruto" --verbose
# Should show DEBUG logging including cache hits/misses


================================================================================
SECTION 3: DOWNLOAD FEATURES (20 Minutes)
================================================================================

3.1 SINGLE EPISODE
------------------
python3 auto_pahe.py -s "Naruto" -i 0 -d 1
# Should download episode 1

3.2 MULTI-EPISODE (Sequential)
-------------------------------
python3 auto_pahe.py -s "Naruto" -i 0 -md "1-3"
# Should download episodes 1, 2, 3 sequentially

3.3 MULTI-EPISODE (Parallel)
-----------------------------
python3 auto_pahe.py -s "Naruto" -i 0 -md "1-3" -w 2
# Should download 2 episodes at a time

3.4 SEASON DOWNLOAD
-------------------
python3 auto_pahe.py -s "Naruto" -i 0 --season 1
# Should attempt episodes 1-12

3.5 WITH NOTIFICATIONS
----------------------
python3 auto_pahe.py -s "Naruto" -i 0 -md "1-2" --notify
# Should send desktop notification when complete
# Linux: check notification center
# macOS: check notification center
# Windows: check action center

3.6 QUIET MODE
--------------
python3 auto_pahe.py -s "Naruto" -i 0 -d 1 --quiet
# Should show minimal output (warnings/errors only)


================================================================================
SECTION 4: CACHING FEATURES (5 Minutes)
================================================================================

4.1 CACHE POPULATION
--------------------
python3 auto_pahe.py -s "Naruto"
# First search - will cache results

4.2 CACHE HIT
-------------
python3 auto_pahe.py -s "Naruto" --verbose
# Should show "Loaded search results from disk cache"

4.3 CACHE STATS
---------------
python3 auto_pahe.py --cache stats
# Should show cached files and size

4.4 CACHE CLEAR
---------------
python3 auto_pahe.py --cache clear
# Should clear cache and cookies

python3 auto_pahe.py --cache stats
# Should show 0 files


================================================================================
SECTION 5: RECORDS MANAGEMENT (15 Minutes)
================================================================================

5.1 VIEW ALL RECORDS
--------------------
python3 auto_pahe.py -R view
# Should list all records in JSON format

5.2 SEARCH RECORDS
------------------
python3 auto_pahe.py -R search "naruto"
# Should find matching records

5.3 UPDATE PROGRESS
-------------------
# First, note an existing record ID or title
python3 auto_pahe.py -R progress 1 10
# Or by title:
python3 auto_pahe.py -R progress "Naruto" 10
# Should update current episode to 10

5.4 RATE ANIME
--------------
python3 auto_pahe.py -R rate 1 9.0
# Or by title:
python3 auto_pahe.py -R rate "Naruto" 9.0
# Should set rating to 9.0

5.5 RENAME RECORD
-----------------
python3 auto_pahe.py -R rename 1 "Naruto Shippuden"
# Should rename the record

5.6 SET KEYWORD
---------------
python3 auto_pahe.py -R set-keyword 1 "naruto-shippuden"
# Should update search keyword

5.7 LIST BY STATUS
------------------
python3 auto_pahe.py -R list-status "watching"
# Should show records with "watching" in status

python3 auto_pahe.py -R list-status "completed"
# Should show completed records

5.8 EXPORT RECORDS (JSON)
--------------------------
python3 auto_pahe.py -R export /tmp/records_backup.json json
# Should create JSON export

5.9 EXPORT RECORDS (CSV)
-------------------------
python3 auto_pahe.py -R export /tmp/records_backup.csv csv
# Should create CSV export with headers

5.10 IMPORT RECORDS
-------------------
python3 auto_pahe.py -R import /tmp/records_backup.json
# Should import and merge records

5.11 DELETE RECORD
------------------
python3 auto_pahe.py -R delete 1
# Or by title:
python3 auto_pahe.py -R delete "Naruto"
# Should remove record


================================================================================
SECTION 6: SORTING FEATURES (10 Minutes)
================================================================================

6.1 SORT ALL (DRY RUN)
----------------------
python3 auto_pahe.py --sort all --sort-path ~/Downloads --sort-dry-run
# Should simulate sorting without changes

6.2 SORT RENAME
---------------
python3 auto_pahe.py --sort rename --sort-path ~/Downloads
# Should rename AnimePahe files

6.3 SORT ORGANIZE
-----------------
python3 auto_pahe.py --sort organize --sort-path ~/Downloads
# Should organize files into anime folders

6.4 AUTO-SORT VIA CONFIG
-------------------------
# Edit config: sort_on_complete=true, sort_mode=all
python3 auto_pahe.py -s "Naruto" -i 0 -d 1
# Should auto-sort after download completes


================================================================================
SECTION 7: EXECUTION STATS (5 Minutes)
================================================================================

7.1 TODAY'S STATS
-----------------
python3 auto_pahe.py -dt "today"
# Should show stats for today

7.2 YESTERDAY
-------------
python3 auto_pahe.py -dt "yesterday"
# Should show stats for yesterday

7.3 LAST WEEK
-------------
python3 auto_pahe.py -dt "last week"
# Should show stats for last 7 days

7.4 DATE RANGE
--------------
python3 auto_pahe.py --summary "from 2025-11-01 to 2025-11-05"
# Should show stats for date range

7.5 ALL TIME
------------
python3 auto_pahe.py --summary "all"
# Should show all execution stats plus records summary


================================================================================
SECTION 8: CONFIGURATION TESTING (10 Minutes)
================================================================================

8.1 GENERATE CONFIG
-------------------
python3 auto_pahe.py --write-config ~/.autopahe_test.ini
# Should create config file

8.2 EDIT CONFIG
---------------
# Edit ~/.autopahe_test.ini:
[defaults]
browser = firefox
resolution = 1080
workers = 2
download_dir = /tmp/autopahe_test

8.3 USE CONFIG
--------------
python3 auto_pahe.py --config ~/.autopahe_test.ini -s "Naruto" --verbose
# Should load config and use 1080p resolution, 2 workers
# Check debug log for "Loaded config from: ~/.autopahe_test.ini"

8.4 CLI OVERRIDE
----------------
python3 auto_pahe.py --config ~/.autopahe_test.ini -p 720 -w 1
# Should override config values with CLI args


================================================================================
SECTION 9: LOGGING LEVELS (5 Minutes)
================================================================================

9.1 DEFAULT LOGGING
-------------------
python3 auto_pahe.py -s "Naruto" -i 0
# Should show INFO level (normal)

9.2 VERBOSE LOGGING
-------------------
python3 auto_pahe.py -s "Naruto" -i 0 --verbose
# Should show DEBUG level (detailed)
# Look for: cache hits, filter info, etc.

9.3 QUIET LOGGING
-----------------
python3 auto_pahe.py -s "Naruto" -i 0 --quiet
# Should show WARNING level only (minimal)


================================================================================
SECTION 10: ERROR HANDLING (5 Minutes)
================================================================================

10.1 INVALID SEARCH
-------------------
python3 auto_pahe.py -s "xyzabcnonexistent12345"
# Should show friendly error with tips

10.2 INVALID INDEX
------------------
python3 auto_pahe.py -s "Naruto" -i 999
# Should show "Invalid index" error

10.3 NO FILTERS MATCH
---------------------
python3 auto_pahe.py -s "Naruto" --year 1900
# Should show "No anime found matching your search with the given filters"


================================================================================
SECTION 11: INTEGRATION TESTS (15 Minutes)
================================================================================

11.1 FULL WORKFLOW
------------------
# Search with filters + download + notify + sort
python3 auto_pahe.py -s "Naruto" --year 2007 -i 0 --season 1 -w 2 --notify
python3 auto_pahe.py --sort all --sort-path ~/Downloads

11.2 CONFIG + FILTERS + RECORDS
--------------------------------
# Use config with auto-sort enabled
python3 auto_pahe.py --config ~/.autopahe_test.ini -s "Naruto" --year 2007 -i 0 -md "1-3"
# Check records
python3 auto_pahe.py -R view
# Update progress
python3 auto_pahe.py -R progress "Naruto" 3
# Rate
python3 auto_pahe.py -R rate "Naruto" 9.5

11.3 CACHE + NOTIFICATIONS + STATS
-----------------------------------
# First run (populate cache)
python3 auto_pahe.py -s "Bleach" -i 0 -d 1 --notify
# Check cache
python3 auto_pahe.py --cache stats
# Second run (use cache)
python3 auto_pahe.py -s "Bleach" --verbose
# Check stats
python3 auto_pahe.py --summary "today"


================================================================================
SECTION 12: PLATFORM-SPECIFIC TESTS
================================================================================

12.1 LINUX
----------
# Notifications (requires notify-send)
which notify-send
python3 auto_pahe.py -s "Naruto" -i 0 -d 1 --notify
# Check notification appears

12.2 MACOS
----------
# Notifications (via osascript)
python3 auto_pahe.py -s "Naruto" -i 0 -d 1 --notify
# Check notification center

12.3 WINDOWS
------------
# Notifications (via PowerShell)
python3 auto_pahe.py -s "Naruto" -i 0 -d 1 --notify
# Check action center


================================================================================
SECTION 13: PERFORMANCE VALIDATION
================================================================================

13.1 CACHE SPEEDUP
------------------
# Clear cache
python3 auto_pahe.py --cache clear

# First search (no cache)
time python3 auto_pahe.py -s "Naruto"

# Second search (with cache)
time python3 auto_pahe.py -s "Naruto"
# Should be faster

13.2 PARALLEL DOWNLOAD SPEED
-----------------------------
# Sequential
time python3 auto_pahe.py -s "Naruto" -i 0 -md "1-3" -w 1

# Parallel (if stable on your system)
time python3 auto_pahe.py -s "Naruto" -i 0 -md "1-3" -w 2
# Should be faster (but may trigger DDoS-Guard)

13.3 COOKIES PERSISTENCE
------------------------
# First run (saves cookies)
python3 auto_pahe.py -s "Naruto" -i 0 -d 1 --verbose
# Look for "Saved cookies"

# Second run (loads cookies)
python3 auto_pahe.py -s "Naruto" -i 0 -d 2 --verbose
# Look for "Loaded cookies"
# Should have fewer DDoS-Guard challenges


================================================================================
SECTION 14: REGRESSION TESTING
================================================================================

Ensure old functionality still works:

14.1 BASIC COMMANDS
-------------------
python3 auto_pahe.py -s "Naruto"
python3 auto_pahe.py -s "Naruto" -i 0
python3 auto_pahe.py -s "Naruto" -i 0 -d 1
python3 auto_pahe.py -s "Naruto" -i 0 -md "1-3"
python3 auto_pahe.py -s "Naruto" -i 0 -a

14.2 OLD RECORD COMMANDS
------------------------
python3 auto_pahe.py -r view
python3 auto_pahe.py -r 1
python3 auto_pahe.py -r "naruto"

14.3 EXECUTION DATA
-------------------
python3 auto_pahe.py -dt "today"
python3 auto_pahe.py -dt "last week"


================================================================================
SECTION 15: STRESS TESTING (Optional)
================================================================================

15.1 LARGE EPISODE RANGE
-------------------------
python3 auto_pahe.py -s "Naruto" -i 0 -md "1-50" -w 1 --quiet
# Should handle gracefully

15.2 CACHE BUILDUP
------------------
# Search many different anime
for anime in "Naruto" "Bleach" "One Piece" "Death Note" "Attack on Titan"; do
    python3 auto_pahe.py -s "$anime"
done
# Check cache size
python3 auto_pahe.py --cache stats

15.3 RECORDS SCALE
------------------
# Create/import many records
python3 auto_pahe.py -R view
# Should handle large JSON output


================================================================================
SECTION 16: CLEANUP AFTER TESTING
================================================================================

python3 auto_pahe.py --cache clear
rm ~/.autopahe_test.ini
rm /tmp/test_config.ini /tmp/records_backup.*


================================================================================
EXPECTED RESULTS SUMMARY
================================================================================

ALL TESTS SHOULD:
-----------------
[✓] Execute without syntax errors
[✓] Show appropriate output for each command
[✓] Handle errors gracefully with helpful messages
[✓] Preserve DDoS-Guard bypass functionality
[✓] Maintain backward compatibility
[✓] Work across platforms (Linux/macOS/Windows)

NOTIFICATIONS SHOULD:
---------------------
[✓] Appear on Linux (if notify-send installed)
[✓] Appear on macOS (via Notification Center)
[✓] Appear on Windows (via Action Center)
[✓] Fail silently if notification system unavailable

CACHE SHOULD:
-------------
[✓] Store API responses in ~/.cache/autopahe/
[✓] Show stats with file count and size
[✓] Speed up repeat searches
[✓] Clear completely with --cache clear

RECORDS SHOULD:
---------------
[✓] Support all CRUD operations
[✓] Handle index or title lookups
[✓] Export to JSON and CSV formats
[✓] Import and merge without duplicates

FILTERS SHOULD:
---------------
[✓] Narrow search results by year
[✓] Narrow search results by status
[✓] Combine filters (AND logic)
[✓] Show friendly message if no matches


================================================================================
KNOWN ISSUES / LIMITATIONS
================================================================================

1. Parallel Downloads (workers > 1)
   - May trigger DDoS-Guard protection
   - Use with caution, default is sequential (workers=1)

2. Notifications
   - Require platform-specific dependencies
   - Fail silently if unavailable (by design)

3. Progress Bar
   - Requires tqdm library (pip install tqdm)
   - Falls back to logging if unavailable

4. Cache
   - Grows over time; manual cleanup via --cache clear
   - 6-hour expiry for API responses
   - 24-hour expiry for cookies

5. Season Download
   - Assumes 12-13 episodes per season
   - May need adjustment for non-standard seasons
   - Use manual range (e.g., -md "1-26") for precise control


================================================================================
REPORTING ISSUES
================================================================================

If tests fail:
1. Note the exact command that failed
2. Include --verbose output
3. Check autopahe.log for detailed errors
4. Verify dependencies installed (tqdm, notify-send, etc.)
5. Test with --cache clear (in case of stale cache)


================================================================================
END OF TESTING GUIDE
================================================================================

Happy testing!
