AutoPahe Upgrade Plan

Phase 1 — Codebase Restructure (Clean Architecture) [COMPLETED]
- [X] Extract UI banners to ap_core/banners.py (Banners, n)
- [X] Extract browser handling to ap_core/browser.py (make_firefox_driver, browser, driver_output, cleanup)
- [X] Centralize HTTP session and caching in ap_core/browser.py for now (get_request_session, cached_request)
- [X] Update auto_pahe.py imports to use ap_core modules
- [X] Keep behavior identical (no functional changes)
- [X] Extract parser to ap_core/parser.py (parse_mailfunction_api)

Phase 2 — Feature Enhancements [COMPLETED]
- [X] Quality selection toggle (480p/720p/1080p) with auto-fallback (reverted per user request; kept original behavior)
- [X] Resume downloads: continue partial files if interrupted (kwikdown already uses Range headers)
- [X] Sorting integration (pahesort): --sort, --sort-path, --sort-dry-run, auto-sort via config
- [X] Robust records management: -R with subcommands (view/search/delete/progress/rate/rename/set-keyword/list-status/export/import)
- [X] Enhanced execution tracker: 'all' and 'from X to Y' date ranges
- [X] Summary command: --summary (execution stats + records summary)
- [X] Config file (.ini) for defaults (browser, resolution, workers, download_dir, sort options)
- [X] Batch/Season selection helpers (--season flag for quick season downloads)
- [X] Filters for lookup: --year and --status for search filtering
- [X] Notifications (desktop) when downloads complete via --notify flag

Phase 3 — Performance Improvements [COMPLETED]
- [X] Optional parallel download toggle with safe staggering (exposed via -w/--workers CLI)
- [X] Persistent cookies jar to reduce DDoS-Guard friction between runs (automatic)
- [X] Cache search and release API responses on disk (automatic with 6-hour expiry)
- [X] Cache management commands: --cache clear|stats
- [ ] Reuse a single Firefox instance for multiple episode page fetches (pooling) [DEFERRED: stability concerns]
- [ ] Adaptive waits based on first page timings (learned timings) [DEFERRED: not critical]

Phase 4 — DX & UX [COMPLETED]
- [X] CLI prompts: skip interactive mode when args provided (already working)
- [X] Progress bars for multi-download queue (tqdm integration)
- [X] Rich logging levels: --verbose / --quiet
- [X] Better error messages for no links / captchas (enhanced with emoji and tips)

Notes
- Preserve the working DDoS-Guard bypass (refresh + implicitly_wait).
- Avoid over-optimizing Firefox prefs that break site JS.
- Keep defaults stable (sequential downloads) and allow opt-in speed.
